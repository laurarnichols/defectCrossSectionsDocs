<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="This page gives a summary of the VASP calculations needed for a capture calculation, including parameter specifications and tips.">
<meta name="keywords" content="vasp,  vasp">
<title>VASP | Defect Cross Sections</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">


<script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="defectCrossSections" href="http://localhost:4000/feed.xml">



    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Defect Cross Sections</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Show site nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/laurarnichols/defectCrossSections" target="_blank" rel="noopener">GitHub</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.vasp.at/wiki/index.php/The_VASP_Manual" target="_blank" rel="noopener">VASP Wiki</a></li>
                        
                        
                        
                        <li><a href="https://phonopy.github.io/phonopy/" target="_blank" rel="noopener">Phonopy Docs</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:laurarnichols@gmail.com?subject=Defect Cross Sections feedback&body=I have some feedback about the VASP page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Need help?</a>

</li>



		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="VASP">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>



<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                
<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Defect Cross Sections 0.0</li>
  
  
  
      
  
  <li>
      <a title="Overview" href="#">Overview</a>
      <ul>
          
          
          
          <li><a title="Introduction" href="index.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a title="Getting started" href="getting-started.html">Getting started</a></li>
          
          
          
          
          
          
          <li><a title="Theory" href="theory.html">Theory</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Calculations" href="#">Calculations</a>
      <ul>
          
          
          
          <li class="active"><a title="VASP" href="vasp.html">VASP</a></li>
          
          
          
          
          
          
          <li><a title="Export" href="calculations_export.html">Export</a></li>
          
          
          
          
          
          
          <li><a title="Energy tabulator" href="calculations_energy-tabulator.html">Energy tabulator</a></li>
          
          
          
          
          
          
          <li><a title="Phonons" href="phonons.html">Phonons</a></li>
          
          
          
          
          
          
          <li><a title="PhononPP" href="calculations_phononpp.html">PhononPP</a></li>
          
          
          
          
          
          
          <li><a title="TME" href="calculations_tme.html">TME</a></li>
          
          
          
          
          
          
          <li><a title="LSF" href="calculations_lsf.html">LSF</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Code" href="#">Code</a>
      <ul>
          
          
          
          <li><a title="Export" href="code_export.html">Export</a></li>
          
          
          
          
          
          
          <li><a title="Energy tabulator" href="code_energy-tabulator.html">Energy tabulator</a></li>
          
          
          
          
          
          
          <li><a title="PhononPP" href="code_phononpp.html">PhononPP</a></li>
          
          
          
          
          
          
          <li><a title="TME" href="code_tme.html">TME</a></li>
          
          
          
          
          
          
          <li><a title="LSF" href="code_lsf.html">LSF</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>



            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">VASP</h1>
</div>



<div class="post-content">

   
    <div class="summary">This page gives a summary of the VASP calculations needed for a capture calculation, including parameter specifications and tips.</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>



    


    

   <p>The following VASP calculations are needed for a capture calculation:</p>
<ul>
  <li>relaxed perfect crystal (plus SCF after)</li>
  <li>relaxed final charge state (plus SCF after)</li>
  <li>relaxed initial charge state (plus SCF after)</li>
  <li>SCF for final charge state in initial positions</li>
</ul>

<p>The displacement between the initial- and final-charge-state relaxed positions gives the $\Delta q_j$ that determines how the electronic energy is split into the different phonon modes. It is recommended to extract the energies (using <a href="calculations_energy-tabulator.html"><code class="language-plaintext highlighter-rouge">EnergyTabulator</code></a>) from the ground-state system in the initial relaxed positions. The wave functions are only needed from the perfect crystal and final charge state/initial positions.</p>

<p>The wave functions and energies are extracted using <a href="calculations_export.html"><code class="language-plaintext highlighter-rouge">Export</code></a>. For any calculations where only the final positions are needed, it is not required to do an SCF calculation after or to run <a href="calculations_export.html"><code class="language-plaintext highlighter-rouge">Export</code></a>.</p>

<h2 id="recommended-order">Recommended order</h2>

<p>To run the VASP calculations, you must set up your perfect-crystal and defect-crystal supercells. The recommended order for this is</p>
<ul>
  <li>volume relax the unit cell</li>
  <li>scale up to supercell</li>
  <li>relax inner degrees of freedom (DOF) for pristine supercell (plus SCF after)</li>
  <li>introduce your defect in the middle of the supercell</li>
  <li>relax inner DOF for defect supercell in ground state</li>
  <li>rest of VASP defect calculations to get all wave functions and positions needed</li>
</ul>

<p>It is recommended to start with the ground state of the defect supercell because it is easiest to converge. The <code class="language-plaintext highlighter-rouge">CONTCAR</code>, <code class="language-plaintext highlighter-rouge">WAVECAR</code>, and <code class="language-plaintext highlighter-rouge">CHGCAR</code> from the ground-state relaxation can be used as a starting point for the rest of the defect calculations.</p>

<p>If you are using more than 1 k-point with a large supercell, it is recommended to</p>
<ul>
  <li>relax at gamma (if relaxation needed)</li>
  <li>SCF at gamma</li>
  <li>NSCF at full k-point grid (<code class="language-plaintext highlighter-rouge">ICHARG=11</code>)</li>
</ul>

<p>For HSE calculations, start from a preconverged PBE calculation for speed. The <a href="calculations_export.html"><code class="language-plaintext highlighter-rouge">Export</code></a> code is not currently implemented for the gamma-only version of VASP, except for exporting the energies only, so keep that in mind when running HSE calculations especially. If you do use the gamma-only version to get accurate HSE energies, make sure that your preconverged PBE calculation was run using the gamma-only version as well, otherwise you will get an error saying <code class="language-plaintext highlighter-rouge">plane wave coefficients changed</code>.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="ediff"><a href="https://www.vasp.at/wiki/index.php/EDIFF" target="_blank"><code class="language-plaintext highlighter-rouge">EDIFF</code></a></h3>

<p>For the relaxations, it is okay to use a looser <code class="language-plaintext highlighter-rouge">EDIFF</code> like <code class="language-plaintext highlighter-rouge">1e-5</code>, but we use the wave functions from the SCF calculations, so the convergence criteria must be tighter for those. We have used <code class="language-plaintext highlighter-rouge">1e-8</code> in the past. To ensure that your convergence is tight enough, run the <a href="calculations_tme.html"><code class="language-plaintext highlighter-rouge">TME</code></a> code with the same system input for both <code class="language-plaintext highlighter-rouge">PC</code> and <code class="language-plaintext highlighter-rouge">SD</code> and a small set of bands used for the initial state and final state. Check the <code class="language-plaintext highlighter-rouge">|&lt;f|i&gt;|^2</code> column in the <code class="language-plaintext highlighter-rouge">allElecOverlap.*.*</code> file to ensure that the bands are orthonormal. For the same initial and final band, the overlap should be close to 1. For different initial and final bands, the overlap should be close to zero (<code class="language-plaintext highlighter-rouge">~1e-10</code> is usually good).</p>

<h3 id="nbands"><a href="https://www.vasp.at/wiki/index.php/NBANDS" target="_blank"><code class="language-plaintext highlighter-rouge">NBANDS</code></a></h3>

<p>From the VASP wiki:</p>
<blockquote>
  <p>In the electronic minimization calculations, empty states do not contribute to the total energy, however, empty states are required to achieve a better convergence.</p>
</blockquote>

<p>The default setting in VASP already includes extra bands above the filled states to get better convergence; however, we need accurate calculations of both occupied and unoccupied states when considering electron capture. For electron capture, ensure that <code class="language-plaintext highlighter-rouge">NBANDS</code> is set so that there are plenty empty bands <em>above the empty states that you are using for your initial electron states.</em> The default value from VASP is <code class="language-plaintext highlighter-rouge">NELECT/2+NIONS/2</code>. You should at least increase above the default by the number of unoccupied states that you need.</p>

<h3 id="isym"><a href="https://www.vasp.at/wiki/index.php/ISYM" target="_blank"><code class="language-plaintext highlighter-rouge">ISYM</code></a></h3>

<p>Our code is not currently implemented with symmetrization, so symmetry must be completely turned off with <code class="language-plaintext highlighter-rouge">ISYM=-1</code>.</p>

<h3 id="ispin"><a href="https://www.vasp.at/wiki/index.php/ISPIN" target="_blank"><code class="language-plaintext highlighter-rouge">ISPIN</code></a></h3>

<p>Make sure that the proper choice of <code class="language-plaintext highlighter-rouge">ISPIN</code> is used for each of your calculations. The <a href="calculations_export.html"><code class="language-plaintext highlighter-rouge">Export</code></a> and <a href="calculations_tme.html"><code class="language-plaintext highlighter-rouge">TME</code></a> codes handle spin polarization automatically, so it is not required to use the same setting for every system.</p>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        
        
    </div>







</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2023 Pantelides-group and Zhang-group collaboration. All rights reserved. <br />
 Site last generated: Sep 12, 2023 <br />
<!--<p><img src="images/company_logo.png" alt="Company logo"/></p>-->
                </div>
            </div>
</footer>






        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>


